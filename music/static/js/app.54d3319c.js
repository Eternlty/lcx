(function(t){function e(e){for(var s,a,o=e[0],c=e[1],l=e[2],d=0,h=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&h.push(r[a][0]),r[a]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);u&&u(e);while(h.length)h.shift()();return n.push.apply(n,l||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],s=!0,o=1;o<i.length;o++){var c=i[o];0!==r[c]&&(s=!1)}s&&(n.splice(e--,1),t=a(a.s=i[0]))}return t}var s={},r={app:0},n=[];function a(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=s,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)a.d(i,s,function(e){return t[e]}.bind(null,s));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/lcx/music/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"4e4f":function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);var s=i("2b0e"),r=function(){var t=this,e=t._self._c;return e("router-view")},n=[],a={name:"App"},o=a,c=(i("f7e5"),i("2877")),l=Object(c["a"])(o,r,n,!1,null,null,null),u=l.exports,d=i("8c4f"),h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"player-container",class:{landscape:t.isLandscape}},[e("div",{staticClass:"background",style:{backgroundImage:"url("+(t.currentSong.cover||"/img/background.jpg")+")"}}),e("div",{staticClass:"glass-overlay"}),e("div",{staticClass:"main-content"},[e("div",{staticClass:"content-wrapper"},[e("div",{staticClass:"song-list"},[e("table",[t._m(0),e("tbody",t._l(t.localMusicList,(function(i,s){return e("tr",{key:i.id,class:{selected:i.id===t.currentSong.id},on:{click:function(e){return t.selectSong(i)}}},[e("td",[t._v(t._s(s+1))]),e("td",[t._v(t._s(i.title))]),e("td",[t._v(t._s(i.artist))])])})),0)])]),e("div",{staticClass:"player-area"},[e("div",{staticClass:"cover-info"},[t.currentSong.cover?e("img",{staticClass:"cover",attrs:{src:t.currentSong.cover}}):t._e()]),e("div",{staticClass:"lyric-box"},[t.currentSong.id?t._l(t.lyrics,(function(i,s){return e("div",{key:s,class:{active:s===t.currentLyricIndex}},[t._v(" "+t._s(i.text)+" ")])})):e("div",{staticClass:"no-music"},[t._v(" 请选择音乐 ")])],2),e("div",{staticClass:"controls"},[e("div",{staticClass:"button-group"},[e("button",{attrs:{title:"上一首"},on:{click:t.prevSong}},[e("i",{staticClass:"fas fa-step-backward"})]),e("button",{attrs:{title:t.isPlaying?"暂停":"播放"},on:{click:t.togglePlay}},[e("i",{class:t.isPlaying?"fas fa-pause":"fas fa-play"})]),e("button",{attrs:{title:"下一首"},on:{click:t.nextSong}},[e("i",{staticClass:"fas fa-step-forward"})]),t.isMobile?e("button",{staticClass:"landscape-btn",attrs:{title:"横屏模式"},on:{click:t.toggleLandscape}},[e("i",{class:t.isLandscape?"fas fa-mobile-alt":"fas fa-sync-alt"})]):t._e()]),e("div",{staticClass:"slider-container"},[t._m(1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentTime,expression:"currentTime"}],staticClass:"progress-slider",attrs:{type:"range",min:"0",max:t.duration,title:"播放进度"},domProps:{value:t.currentTime},on:{input:t.seek,__r:function(e){t.currentTime=e.target.value}}}),e("span",{staticClass:"time-display"},[t._v(" "+t._s(t.formatTime(t.currentTime))+" / "+t._s(t.formatTime(t.duration))+" ")])]),e("div",{staticClass:"slider-container"},[t._m(2),e("input",{directives:[{name:"model",rawName:"v-model",value:t.volume,expression:"volume"}],staticClass:"volume-slider",attrs:{type:"range",min:"0",max:"1",step:"0.01",title:"音量调节"},domProps:{value:t.volume},on:{input:t.setVolume,__r:function(e){t.volume=e.target.value}}}),e("span",{staticClass:"volume-display"},[t._v(" "+t._s(Math.round(100*t.volume))+"% ")])])])])])]),e("audio",{ref:"audio",attrs:{src:t.currentSong.src},on:{timeupdate:t.onTimeUpdate,ended:t.nextSong,play:t.onPlay,pause:t.onPause}})])},p=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",{attrs:{width:"50px"}}),e("th",[t._v("歌曲名")]),e("th",[t._v("歌手")])])])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"slider-icon"},[e("i",{staticClass:"fas fa-clock"})])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"slider-icon"},[e("i",{staticClass:"fas fa-volume-up"})])}];const f=[{id:1,title:"Landslide",artist:"Oh Wonder",cover:"/lcx/music/img/1.jpg",src:"/lcx/music/1.mp3",lrc:"/lcx/lrc/1.lrc"},{id:2,title:"Sacred Play Secret Place",artist:"Matryoshka",cover:"/lcx/music/img/2.jpg",src:"/lcx/music/2.mp3",lrc:"/lcx/lrc/2.lrc"},{id:3,title:"爱情讯息",artist:"郭静",cover:"/lcx/music/img/3.png",src:"/lcx/music/3.mp3",lrc:"/lcx/lrc/3.lrc"},{id:4,title:"第57次取消发送",artist:"菲菲公主（陆绮菲）",cover:"/lcx/music/img/4.jpg",src:"/lcx/music/4.mp3",lrc:"/lcx/lrc/4.lrc"}];function m(t){const e=t.split("\n"),i=[],s=/\[(\d{2}):(\d{2})\.(\d{2,3})]/;for(let r of e){const t=s.exec(r);if(t){const e=parseInt(t[1]),n=parseInt(t[2]),a=parseInt(t[3].padEnd(3,"0")),o=60*e*1e3+1e3*n+a,c=r.replace(s,"").trim();i.push({time:o,text:c})}}return i.sort((t,e)=>t.time-e.time)}var g={name:"MusicPlayer",data(){return{localMusicList:f,currentSong:{},lyrics:[],currentLyricIndex:0,isPlaying:!1,currentTime:0,duration:0,volume:.8,isLandscape:!1,isMobile:window.innerWidth<=800,isLoading:!0,audioCache:new Map}},async mounted(){await this.preloadAudio(),this.initAudio(),this.isLoading=!1,window.addEventListener("keydown",this.handleKeyDown)},beforeDestroy(){window.removeEventListener("keydown",this.handleKeyDown)},methods:{async preloadAudio(){const t=[];for(const e of this.localMusicList){const i=new Audio(e.src);i.preload="auto",this.audioCache.set(e.id,i),t.push(new Promise(t=>{i.addEventListener("canplaythrough",t)}))}await Promise.all(t)},initAudio(){const t=this.$refs.audio;t&&(t.volume=this.volume,t.addEventListener("loadedmetadata",()=>{this.duration=t.duration}))},async loadLyric(){try{const t=await fetch(this.currentSong.lrc),e=await t.text();this.lyrics=m(e),this.currentLyricIndex=0}catch(t){console.error("歌词加载失败:",t),this.lyrics=[{text:"歌词加载失败"}]}},onTimeUpdate(t){this.currentTime=t.target.currentTime;for(let e=0;e<this.lyrics.length;e++)if(1e3*this.currentTime+25<this.lyrics[e].time){this.currentLyricIndex=e-1>=0?e-1:0,this.$nextTick(()=>{const t=this.$el.querySelector(".lyric-box"),e=t.querySelector(".active");e&&e.scrollIntoView({behavior:"smooth",block:"center"})});break}},togglePlay(){if(!this.currentSong.id)return;const t=this.$refs.audio;t.paused?(t.play().catch(t=>{console.error("播放失败:",t),this.isPlaying=!1}),this.isPlaying=!0):(t.pause(),this.isPlaying=!1)},seek(){const t=this.$refs.audio;t&&(console.log("Seeking to:",this.currentTime,"Duration:",this.duration),t.currentTime=this.currentTime,this.isPlaying||t.play().catch(t=>{console.error("Seek后播放失败:",t)}))},setVolume(){this.$refs.audio&&(this.$refs.audio.volume=this.volume)},selectSong(t){this.currentSong=t,this.isPlaying=!1,this.currentTime=0,this.loadLyric(),this.$nextTick(()=>{const t=this.$refs.audio;t&&(t.load(),t.play().then(()=>{this.isPlaying=!0}).catch(t=>{console.error("播放失败:",t),this.isPlaying=!1}))})},prevSong(){if(!this.currentSong.id)return;let t=this.localMusicList.findIndex(t=>t.id===this.currentSong.id);t=(t-1+this.localMusicList.length)%this.localMusicList.length,this.selectSong(this.localMusicList[t])},nextSong(){if(!this.currentSong.id)return;let t=this.localMusicList.findIndex(t=>t.id===this.currentSong.id);t=(t+1)%this.localMusicList.length,this.selectSong(this.localMusicList[t])},onPlay(){this.isPlaying=!0},onPause(){this.isPlaying=!1},formatTime(t){if(isNaN(t))return"00:00";const e=Math.floor(t/60),i=Math.floor(t%60);return`${e.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`},toggleLandscape(){this.isLandscape=!this.isLandscape,this.isLandscape?screen.orientation.lock("landscape").catch(t=>{console.error("锁定横屏失败:",t)}):screen.orientation.unlock()},handleKeyDown(t){if("INPUT"!==t.target.tagName)switch(t.key){case" ":t.preventDefault(),this.togglePlay();break;case"ArrowLeft":t.preventDefault(),this.$refs.audio.currentTime=Math.max(0,this.currentTime-5);break;case"ArrowRight":t.preventDefault(),this.$refs.audio.currentTime=Math.min(this.duration,this.currentTime+5);break;case"ArrowUp":t.preventDefault(),this.prevSong();break;case"ArrowDown":t.preventDefault(),this.nextSong();break}},closeNotice(){this.dontShow&&localStorage.setItem("dontShowShortcutNotice","true"),this.showShortcutNotice=!1}}},v=g,y=(i("eade"),Object(c["a"])(v,h,p,!1,null,"bd530324",null)),b=y.exports;s["a"].use(d["a"]);var w=new d["a"]({mode:"history",routes:[{path:"/lcx/music/",name:"Music",component:b}]}),x=i("2f62");s["a"].use(x["a"]);var S=new x["a"].Store({state:{},mutations:{},actions:{},getters:{}});i("a4b1");s["a"].config.productionTip=!1,new s["a"]({router:w,store:S,render:t=>t(u)}).$mount("#app")},a4b1:function(t,e,i){},eade:function(t,e,i){"use strict";i("fc5f")},f7e5:function(t,e,i){"use strict";i("4e4f")},fc5f:function(t,e,i){}});